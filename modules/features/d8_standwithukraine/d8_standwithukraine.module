<?php

/**
 * @file
 * Provides a wrapper for the StandWithUkraine module.
 */

/**
 * Implements hook_preprocess_HOOK().
 */
function d8_standwithukraine_preprocess_standwithukraine(&$variables) {
  if (
    empty($theme = \Drupal::config('system.theme')->get('admin')) ||
    \Drupal::theme()->getActiveTheme()->getName() !== $theme
  ) {
    return;
  }

  $offset = 117;

  /** @var \Drupal\Core\Menu\LocalTaskManagerInterface $service */
  $service = \Drupal::service('plugin.manager.menu.local_task');

  $items = $service->getLocalTasksForRoute(
    \Drupal::routeMatch()->getRouteName()
  );

  if (!empty($items)) {
    $offset += 51;
  }

  /** @var \Drupal\Core\Template\Attribute $attributes */
  $attributes = $variables['attributes'];

  $attributes
    ->addClass('right')
    ->setAttribute('style', 'top: ' . $offset . 'px');
}
